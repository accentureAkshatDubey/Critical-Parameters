version: 0.0.32
jobId: "985"
jobName: Inspection Item Parameter Detail
jobType: Source Aligned Data Product
domain: quality_assurance
alias: Iceberg_Write
discoveryPort:
  name: Inspection Item Parameter Detail
inputPorts:
  - alias: qacp_tran_1
    isDynamic: true
    tableLocation: s3://msil-data-lake-curated/sr2/ppc_de/qacp_tran
    optional:
      persistDataFrame: false
      enableDataReconciliation: false
      enforceSchema: false
      connection: Critical Parameter S3 Connectivity
      dataSetUrn: urn:dv:dataset:86706ad0-8044-47a7-9c5e-44feedab5b54
    type: readDeltaTable
  - alias: qacp_insp_item_1
    isDynamic: true
    tableLocation: s3://msil-data-lake-curated/sr2/ppc_de/qacp_insp_item
    optional:
      persistDataFrame: false
      enableDataReconciliation: false
      enforceSchema: false
      connection: Critical Parameter S3 Connectivity
      dataSetUrn: urn:dv:dataset:a7c6f74c-2658-43d2-a661-985951c3c822
    type: readDeltaTable
productState:
  isDynamic: true
  alias: Iceberg_Write
  retentionVersions: ""
  logicalSchema:
    properties:
      tran_part_code:
        type: STRING
        description: ""
        sourceColumn: TRAN_PART_CODE
        sourceTable: QACP_TRAN
      tran_insp_sr_no:
        type: STRING
        description: ""
        sourceColumn: "TRAN_INSP_SR_NO "
        sourceTable: QACP_TRAN
      tran_prod_stats:
        type: STRING
        description: ""
        sourceColumn: "TRAN_PROD_STATS "
        sourceTable: QACP_TRAN
      tran_prod_date:
        type: DATETIME
        description: ""
        sourceColumn: "TRAN_PROD_DATE "
        sourceTable: QACP_TRAN
      tran_line_code:
        type: STRING
        description: ""
        sourceColumn: "TRAN_LINE_CODE "
        sourceTable: QACP_TRAN
      tran_shift:
        type: STRING
        description: ""
        sourceColumn: TRAN_SHIFT
        sourceTable: QACP_TRAN
      tran_btch_code:
        type: STRING
        description: ""
        sourceColumn: "TRAN_BTCH_CODE "
        sourceTable: QACP_TRAN
      tran_prod_count:
        type: STRING
        description: ""
        sourceColumn: TRAN_PROD_COUNT
        sourceTable: QACP_TRAN
      tran_sample1:
        type: STRING
        description: ""
        sourceColumn: "TRAN_SAMPLE1 "
        sourceTable: QACP_TRAN
      tran_sample2:
        type: STRING
        description: ""
        sourceColumn: "TRAN_SAMPLE2 "
        sourceTable: QACP_TRAN
      tran_sample3:
        type: STRING
        description: ""
        sourceColumn: "TRAN_SAMPLE3 "
        sourceTable: QACP_TRAN
      tran_sample4:
        type: STRING
        description: ""
        sourceColumn: "TRAN_SAMPLE4 "
        sourceTable: QACP_TRAN
      tran_sample5:
        type: STRING
        description: ""
        sourceColumn: "TRAN_SAMPLE5 "
        sourceTable: QACP_TRAN
      tran_sample6:
        type: STRING
        description: ""
        sourceColumn: "TRAN_SAMPLE6 "
        sourceTable: QACP_TRAN
      tran_sample7:
        type: STRING
        description: ""
        sourceColumn: "TRAN_SAMPLE7 "
        sourceTable: QACP_TRAN
      tran_sample8:
        type: STRING
        description: ""
        sourceColumn: "TRAN_SAMPLE8 "
        sourceTable: QACP_TRAN
      tran_sample9:
        type: STRING
        description: ""
        sourceColumn: "TRAN_SAMPLE9 "
        sourceTable: QACP_TRAN
      tran_sample10:
        type: STRING
        description: ""
        sourceColumn: "TRAN_SAMPLE10 "
        sourceTable: QACP_TRAN
      insp_part_code:
        type: STRING
        description: ""
        sourceColumn: "INSP_PART_CODE "
        sourceTable: QACP_INSP_ITEM
      insp_sr_no:
        type: STRING
        description: ""
        sourceColumn: INSP_SR_NO
        sourceTable: QACP_INSP_ITEM
      insp_ltlr:
        type: STRING
        description: ""
        sourceColumn: INSP_LTLR
        sourceTable: QACP_INSP_ITEM
      insp_utlr:
        type: STRING
        description: ""
        sourceColumn: "INSP_UTLR "
        sourceTable: QACP_INSP_ITEM
      insp_item:
        type: STRING
        description: ""
        sourceColumn: "INSP_ITEM "
        sourceTable: QACP_INSP_ITEM
      insp_smpl_cnt:
        type: STRING
        description: ""
        sourceColumn: "INSP_SMPL_CNT "
        sourceTable: QACP_INSP_ITEM
      insp_from_date:
        type: DATETIME
        description: ""
        sourceColumn: "INSP_FROM_DATE "
        sourceTable: QACP_INSP_ITEM
      insp_to_date:
        type: DATETIME
        description: ""
        sourceColumn: "INSP_TO_DATE "
        sourceTable: QACP_INSP_ITEM
      insp_base_value:
        type: STRING
        description: ""
        sourceColumn: "INSP_BASE_VALUE "
        sourceTable: QACP_INSP_ITEM
      insp_unit:
        type: STRING
        description: ""
        sourceColumn: INSP_UNIT
        sourceTable: QACP_INSP_ITEM
      insp_ctrl_band:
        type: STRING
        description: ""
        sourceColumn: INSP_CTRL_BAND
        sourceTable: QACP_INSP_ITEM
      insp_smpl_feq:
        type: STRING
        description: ""
        sourceColumn: INSP_SMPL_FEQ
        sourceTable: QACP_INSP_ITEM
      insp_part_rmrk:
        type: STRING
        description: ""
        sourceColumn: "INSP_PART_RMRK "
        sourceTable: QACP_INSP_ITEM
      insp_ctrl_limt:
        type: STRING
        description: ""
        sourceColumn: "INSP_CTRL_LIMT "
        sourceTable: QACP_INSP_ITEM
      insp_ctrl_point:
        type: STRING
        description: ""
        sourceColumn: "INSP_CTRL_POINT "
        sourceTable: QACP_INSP_ITEM
      insp_close_alrt:
        type: STRING
        description: ""
        sourceColumn: INSP_CLOSE_ALRT
        sourceTable: QACP_INSP_ITEM
      insp_src:
        type: STRING
        description: ""
        sourceColumn: "INSP_SRC "
        sourceTable: QACP_INSP_ITEM
      insp_catg:
        type: STRING
        description: ""
        sourceColumn: "INSP_CATG "
        sourceTable: QACP_INSP_ITEM
      insp_misp_plan:
        type: STRING
        description: ""
        sourceColumn: "INSP_MISP_PLAN "
        sourceTable: QACP_INSP_ITEM
      insp_vend_code:
        type: STRING
        description: ""
        sourceColumn: "INSP_VEND_CODE "
        sourceTable: QACP_INSP_ITEM
      insp_modl:
        type: STRING
        description: ""
        sourceColumn: "INSP_MODL "
        sourceTable: QACP_INSP_ITEM
      etl_inserted_date:
        type: DATETIME
        description: ETL Audit Field to identify record insertion date
        sourceColumn: Manual
        sourceTable: Manual
      etl_modified_date:
        type: DATETIME
        description: ETL Audit Field to identify record modified date
        sourceColumn: Manual
        sourceTable: Manual
      etl_created_by:
        type: STRING
        description: ETL Audit Field to identify record created by user
        sourceColumn: Manual
        sourceTable: Manual
      etl_updated_by:
        type: STRING
        description: ETL Audit Field to identify record modified by user
        sourceColumn: Manual
        sourceTable: Manual
  stateStoreType: loadDataIceberg
  isProfilingEnabled: false
  updateStrategy: Overwrite
  tableName: msil_dataverse_quality_assurance_catalog.inspection_item_parameter_details
  warehousePath: s3://msil-dataverse-quality-assurance/
  catalogName: glue
  optional:
    persistDataFrame: false
    enableDataReconciliation: false
    enforceSchema: true
    enforceSchemaMethod: Warning
    catalogType: glue
  refreshInterval: 30 5 * * *
transformation:
  - isDynamic: true
    alias: Spark_SQL_1
    description: Transform
    sequence: 3
    inputDataFrameList:
      - inputDataFrame: qacp_tran_1
        tempViewName: QACP_TRAN
      - inputDataFrame: qacp_insp_item_1
        tempViewName: QACP_INSP_ITEM
    query: select  TRAN_PART_CODE ,  TRAN_INSP_SR_NO ,  TRAN_PROD_STATS
      ,  TRAN_PROD_DATE ,  TRAN_LINE_CODE ,  TRAN_SHIFT ,  TRAN_BTCH_CODE
      ,  TRAN_PROD_COUNT ,  TRAN_SAMPLE1 ,  TRAN_SAMPLE2 ,  TRAN_SAMPLE3
      ,  TRAN_SAMPLE4 ,  TRAN_SAMPLE5 ,  TRAN_SAMPLE6 ,  TRAN_SAMPLE7
      ,  TRAN_SAMPLE8 ,  TRAN_SAMPLE9 ,  TRAN_SAMPLE10 ,  INSP_PART_CODE
      ,  INSP_SR_NO ,  INSP_LTLR ,  INSP_UTLR ,  INSP_ITEM ,  INSP_SMPL_CNT
      ,  INSP_FROM_DATE ,  INSP_TO_DATE ,  INSP_BASE_VALUE ,  INSP_UNIT
      ,  INSP_CTRL_BAND ,  INSP_SMPL_FEQ ,  INSP_PART_RMRK ,  INSP_CTRL_LIMT
      ,  INSP_CTRL_POINT ,  INSP_CLOSE_ALRT ,  INSP_SRC ,  INSP_CATG
      ,  INSP_MISP_PLAN,  INSP_VEND_CODE,  INSP_MODL,  current_timestamp() as
      etl_inserted_date,  current_timestamp() as
      etl_modified_date,  'platform_admin' as etl_created_by,  'platform_admin'
      as etl_updated_by from  QACP_TRAN inner join QACP_INSP_ITEM
      on  QACP_TRAN.TRAN_PART_CODE = QACP_INSP_ITEM.INSP_PART_CODE  and
      QACP_TRAN.TRAN_INSP_SR_NO = QACP_INSP_ITEM.INSP_SR_NO  and
      QACP_INSP_ITEM.INSP_VEND_CODE = QACP_TRAN.TRAN_MAINT_PERS  and
      QACP_INSP_ITEM.INSP_MODL = QACP_TRAN.TRAN_MODL;
    optional:
      persistDataFrame: false
    type: operationThroughSqlQuery
controlPort:
  dataQualityRules: {}
outputPort:
  subscriptionChannels:
    - channelType: Postgres
      queryType: SQL
    - channelType: Dataproduct
      queryType: SQL
