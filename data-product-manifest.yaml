version: 0.0.5
jobId: "1058"
jobName: Consolidated Critical Parameter Details
jobType: Aggregated Data Product
domain: quality_assurance
alias: iceberg_state_management
discoveryPort:
  name: Consolidated Critical Parameter Details
inputPorts:
  - alias: Critical_Parameter_Details_1
    isDynamic: true
    dataProductUrn: urn:dv:dataproduct:b9c4d42c-52a2-4858-813c-f5d2cf7050dd
    filter: ""
    projection: ""
    optional:
      persistDataFrame: false
    type: dataproduct
productState:
  persistDataFrame: false
  catalogType: glue
  enforceSchema: false
  stepName: iceberg_state_management
  tableName: msil_dataverse_quality_assurance_catalog.critical_parameter_details_consolidated
  warehousePath: s3://msil-dataverse-quality-assurance/
  catalogName: glue
  type: readDataIceberg
  isStateManagement: true
  sequence: 3
  alias: iceberg_state_management
  refreshInterval: None
  retentionVersions: ""
  logicalSchema:
    properties:
      dept:
        type: STRING
        description: Department
        sourceColumn: dept
        sourceTable: critical_parameter_details
      user_name:
        type: STRING
        description: User name
        sourceColumn: user_name
        sourceTable: critical_parameter_details
      vendor_code:
        type: STRING
        description: Vendor code
        sourceColumn: vendor_code
        sourceTable: critical_parameter_details
      vendor_name:
        type: STRING
        description: Vendor name
        sourceColumn: vendor_name
        sourceTable: critical_parameter_details
      part_code:
        type: STRING
        description: Part code
        sourceColumn: part_code
        sourceTable: critical_parameter_details
      part_name:
        type: STRING
        description: Part name
        sourceColumn: part_name
        sourceTable: critical_parameter_details
      insp_sr_no:
        type: STRING
        description: Serial number
        sourceColumn: insp_sr_no
        sourceTable: critical_parameter_details
      part_modl:
        type: STRING
        description: Part model
        sourceColumn: part_modl
        sourceTable: critical_parameter_details
      tran_line_code:
        type: STRING
        description: Line code
        sourceColumn: tran_line_code
        sourceTable: critical_parameter_details
      prod_date:
        type: STRING
        description: Product date
        sourceColumn: prod_date
        sourceTable: critical_parameter_details
      batch_code:
        type: STRING
        description: Batch code
        sourceColumn: batch_code
        sourceTable: critical_parameter_details
      inspection_item:
        type: STRING
        description: Inspection item
        sourceColumn: inspection_item
        sourceTable: critical_parameter_details
      lsl:
        type: STRING
        description: LSL
        sourceColumn: lsl
        sourceTable: critical_parameter_details
      lcl:
        type: STRING
        description: LCL
        sourceColumn: lcl
        sourceTable: critical_parameter_details
      lcl_control_band:
        type: STRING
        description: LCL control band
        sourceColumn: lcl_control_band
        sourceTable: critical_parameter_details
      ucl_control_band:
        type: STRING
        description: UCL control band
        sourceColumn: ucl_control_band
        sourceTable: critical_parameter_details
      ucl:
        type: STRING
        description: UCL
        sourceColumn: ucl
        sourceTable: critical_parameter_details
      usl:
        type: STRING
        description: USL
        sourceColumn: usl
        sourceTable: critical_parameter_details
      value:
        type: STRING
        description: Value
        sourceColumn: value
        sourceTable: critical_parameter_details
      alert_details:
        type: STRING
        description: Alert details
        sourceColumn: alert_details
        sourceTable: critical_parameter_details
      category:
        type: STRING
        description: Category
        sourceColumn: category
        sourceTable: critical_parameter_details
      etl_inserted_date:
        type: DATETIME
        description: ETL Audit Field to identify record insertion date
        sourceColumn: Manual
        sourceTable: Manual
      etl_modified_date:
        type: DATETIME
        description: ETL Audit Field to identify record modified date
        sourceColumn: Manual
        sourceTable: Manual
      etl_created_by:
        type: STRING
        description: ETL Audit Field to identify record created by user
        sourceColumn: Manual
        sourceTable: Manual
      etl_updated_by:
        type: STRING
        description: ETL Audit Field to identify record modified by user
        sourceColumn: Manual
        sourceTable: Manual
  enforceSchemaMethod: ""
  isProfilingEnabled: false
transformation:
  - isDynamic: true
    alias: EMR_PySpark_1
    description: apply_transformation
    sequence: 2
    arguments: []
    pythonFilePath: s3://msil-dataverse-quality-assurance/Pyspark_Scripts/critical_parameters/consolidated_critical_parameter_details.py
    inputDataFrameList:
      - inputDataFrame: ""
        tempViewName: ""
    optional:
      sparkExtraConf:
        --jars: s3://msil-data-lake-raw/InputData/Test/IMKT/test_iceberg_write/iceberg-core-1.4.3.jar,s3://msil-data-lake-raw/InputData/Test/IMKT/test_iceberg_write/iceberg-spark-runtime-3.3_2.12-1.4.3.jar,s3://msil-data-lake-raw/InputData/Test/IMKT/test_iceberg_write/iceberg-aws-bundle-1.4.3.jar,s3://msil-dataverse-quality-assurance/Temp_Dumps/delta-core_2.12-0.2.0.jar,s3://msil-dataverse-quality-assurance/Temp_Dumps/iceberg-spark3-runtime-0.13.2.jar
    type: customPySparkEMRServerless
controlPort:
  dataQualityRules:
    RecordCountCheck:
      productState:
        expression: ">"
        number: 0
        referenceAlias: iceberg_state_management
    NullValueCheck:
      productState:
        checks:
          - column: PART_VEND_CODE
          - column: INSP_PART_CODE
          - column: INSP_ITEM
          - column: TRAN_PROD_DATE
        referenceAlias: iceberg_state_management
outputPort:
  subscriptionChannels:
    - channelType: Postgres
      queryType: SQL
    - channelType: Dataproduct
      queryType: SQL
