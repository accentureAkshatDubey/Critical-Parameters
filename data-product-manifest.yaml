version: 0.0.25
jobId: "985"
jobName: Inspection Item Parameter Detail
jobType: Source Aligned Data Product
alias: Iceberg_Write
discoveryPort:
  name: Inspection Item Parameter Detail
inputPorts:
  - alias: qacp_tran_1
    isDynamic: true
    tableLocation: s3://msil-data-lake-curated/sr2/ppc_de/qacp_tran
    optional:
      persistDataFrame: false
      enableDataReconciliation: false
      enforceSchema: false
      connection: Critical Parameter S3 Connectivity
      dataSetUrn: urn:dv:dataset:86706ad0-8044-47a7-9c5e-44feedab5b54
    type: readDeltaTable
  - alias: qacp_insp_item_1
    isDynamic: true
    tableLocation: s3://msil-data-lake-curated/sr2/ppc_de/qacp_insp_item
    optional:
      persistDataFrame: false
      enableDataReconciliation: false
      enforceSchema: false
      connection: Critical Parameter S3 Connectivity
      dataSetUrn: urn:dv:dataset:a7c6f74c-2658-43d2-a661-985951c3c822
    type: readDeltaTable
productState:
  isDynamic: true
  alias: Iceberg_Write
  retentionVersions: ""
  logicalSchema:
    properties:
      tran_part_code:
        type: STRING
        description: ""
      tran_insp_sr_no:
        type: STRING
        description: ""
      tran_prod_stats:
        type: STRING
        description: ""
      tran_prod_date:
        type: DATETIME
        description: ""
      tran_line_code:
        type: STRING
        description: ""
      tran_shift:
        type: STRING
        description: ""
      tran_btch_code:
        type: STRING
        description: ""
      tran_prod_count:
        type: STRING
        description: ""
      tran_sample1:
        type: STRING
        description: ""
      tran_sample2:
        type: STRING
        description: ""
      tran_sample3:
        type: STRING
        description: ""
      tran_sample4:
        type: STRING
        description: ""
      tran_sample5:
        type: STRING
        description: ""
      tran_sample6:
        type: STRING
        description: ""
      tran_sample7:
        type: STRING
        description: ""
      tran_sample8:
        type: STRING
        description: ""
      tran_sample9:
        type: STRING
        description: ""
      tran_sample10:
        type: STRING
        description: ""
      insp_part_code:
        type: STRING
        description: ""
      insp_sr_no:
        type: STRING
        description: ""
      insp_ltlr:
        type: STRING
        description: ""
      insp_utlr:
        type: STRING
        description: ""
      insp_item:
        type: STRING
        description: ""
      insp_smpl_cnt:
        type: STRING
        description: ""
      insp_from_date:
        type: DATETIME
        description: ""
      insp_to_date:
        type: DATETIME
        description: ""
      insp_base_value:
        type: STRING
        description: ""
      insp_unit:
        type: STRING
        description: ""
  stateStoreType: loadDataIceberg
  isProfilingEnabled: false
  updateStrategy: Overwrite
  tableName: msil_transformed_layer.inspection_item_parameter_details
  warehousePath: s3://msil-dataverse-quality-assurance/
  catalogName: glue
  optional:
    persistDataFrame: false
    enableDataReconciliation: false
    enforceSchema: true
    enforceSchemaMethod: Warning
    catalogType: glue
  refreshInterval: 0 5 * * *
transformation:
  - alias: Spark_SQL_1
    type: SQL
    description: Transform
    query: select  TRAN_PART_CODE ,  TRAN_INSP_SR_NO ,  TRAN_PROD_STATS
      ,  TRAN_PROD_DATE ,  TRAN_LINE_CODE ,  TRAN_SHIFT ,  TRAN_BTCH_CODE
      ,  TRAN_PROD_COUNT ,  TRAN_SAMPLE1 ,  TRAN_SAMPLE2 ,  TRAN_SAMPLE3
      ,  TRAN_SAMPLE4 ,  TRAN_SAMPLE5 ,  TRAN_SAMPLE6 ,  TRAN_SAMPLE7
      ,  TRAN_SAMPLE8 ,  TRAN_SAMPLE9 ,  TRAN_SAMPLE10 ,  INSP_PART_CODE
      ,  INSP_SR_NO ,  INSP_LTLR ,  INSP_UTLR ,  INSP_ITEM ,  INSP_SMPL_CNT
      ,  INSP_FROM_DATE ,  INSP_TO_DATE ,  INSP_BASE_VALUE ,  INSP_UNIT
      ,  INSP_CTRL_BAND ,  INSP_SMPL_FEQ ,  INSP_PART_RMRK ,  INSP_CTRL_LIMT
      ,  INSP_CTRL_POINT ,  INSP_CLOSE_ALRT ,  INSP_SRC ,  INSP_CATG
      ,  INSP_MISP_PLAN,  INSP_VEND_CODE,  INSP_MODL from  QACP_TRAN inner join
      QACP_INSP_ITEM on  QACP_TRAN.TRAN_PART_CODE =
      QACP_INSP_ITEM.INSP_PART_CODE  and QACP_TRAN.TRAN_INSP_SR_NO =
      QACP_INSP_ITEM.INSP_SR_NO  and QACP_INSP_ITEM.INSP_VEND_CODE =
      QACP_TRAN.TRAN_MAINT_PERS     and QACP_INSP_ITEM.INSP_MODL =
      QACP_TRAN.TRAN_MODL;
    sequenceNo: 3
    references:
      - alias: qacp_tran_1
        sqlReference: QACP_TRAN
      - alias: qacp_insp_item_1
        sqlReference: QACP_INSP_ITEM
controlPort:
  dataQualityRules: {}
outputPort:
  subscriptionChannels:
    - channelType: Postgres
      queryType: SQL
    - channelType: Dataproduct
      queryType: SQL
