version: 0.0.5
jobId: "1057"
jobName: Critical Parameter Details
jobType: Aggregated Data Product
domain: quality_assurance
alias: Write_to_Iceberg
discoveryPort:
  name: Critical Parameter Details
inputPorts:
  - alias: Employee_Master_1
    isDynamic: true
    dataProductUrn: urn:dv:dataproduct:e0432435-1609-43cf-95eb-1396c4ce4c73
    filter: ""
    projection: ""
    optional:
      persistDataFrame: false
    type: dataproduct
  - alias: Inspection_Item_Parameter_Detail_1
    isDynamic: true
    dataProductUrn: urn:dv:dataproduct:1ece1da2-b682-4525-b595-b9ba375a48a4
    filter: ""
    projection: ""
    optional:
      persistDataFrame: false
    type: dataproduct
  - alias: Parts_Accessories_Master_1
    isDynamic: true
    dataProductUrn: urn:dv:dataproduct:3ace113a-e949-4884-8b02-e1caddfcc28b
    filter: ""
    projection: ""
    optional:
      persistDataFrame: false
    type: dataproduct
productState:
  persistDataFrame: false
  catalogType: glue
  enforceSchema: false
  stepName: Write to Iceberg
  tableName: msil_dataverse_quality_assurance_catalog.critical_parameter_details
  warehousePath: s3://msil-dataverse-quality-assurance/
  catalogName: glue
  type: readDataIceberg
  isStateManagement: true
  sequence: 5
  alias: Write_to_Iceberg
  refreshInterval: None
  retentionVersions: ""
  logicalSchema:
    properties:
      username:
        type: STRING
        description: MSIL Concered Department UserName
        sourceColumn: "USERNAME                "
        sourceTable: Fpay_Empl,QACP_PART
      part_user_dept:
        type: STRING
        description: Department ID of User
        sourceColumn: "PART_USER_DEPT          "
        sourceTable: QACP_PART
      insp_part_code:
        type: STRING
        description: Code of Inspection Item
        sourceColumn: "INSP_PART_CODE          "
        sourceTable: QACP_INSP_ITEM
      insp_sr_no:
        type: STRING
        description: Serial Number of Inspection Item
        sourceColumn: "INSP_SR_NO              "
        sourceTable: QACP_INSP_ITEM
      part_desc:
        type: STRING
        description: Part Description
        sourceColumn: "PART_DESC               "
        sourceTable: QACP_PART
      part_vend_code:
        type: STRING
        description: Vendor Code supplying the part
        sourceColumn: "PART_VEND_CODE          "
        sourceTable: QACP_PART
      part_vend_desc:
        type: STRING
        description: Vendor Description
        sourceColumn: "PART_VEND_DESC          "
        sourceTable: QACP_PART
      part_modl:
        type: STRING
        description: "Model of part "
        sourceColumn: "PART_MODL               "
        sourceTable: QACP_PART
      insp_item:
        type: STRING
        description: Inspection Item
        sourceColumn: "INSP_ITEM               "
        sourceTable: QACP_INSP_ITEM
      insp_from_date:
        type: STRING
        description: From date field of inspection item
        sourceColumn: "INSP_FROM_DATE          "
        sourceTable: QACP_INSP_ITEM
      insp_to_date:
        type: STRING
        description: To Date field of inspection item
        sourceColumn: "INSP_TO_DATE            "
        sourceTable: QACP_INSP_ITEM
      tran_prod_date:
        type: STRING
        description: Production Date of Component
        sourceColumn: "TRAN_PROD_DATE          "
        sourceTable: QACP_TRAN
      tran_line_code:
        type: STRING
        description: Line Description
        sourceColumn: "TRAN_LINE_CODE          "
        sourceTable: QACP_TRAN
      tran_shift:
        type: STRING
        description: Shift Name
        sourceColumn: "TRAN_SHIFT              "
        sourceTable: QACP_TRAN
      tran_btch_code:
        type: STRING
        description: Batch Code
        sourceColumn: "TRAN_BTCH_CODE          "
        sourceTable: QACP_TRAN
      tran_prod_stats:
        type: STRING
        description: Prod stats
        sourceColumn: "TRAN_PROD_STATS         "
        sourceTable: QACP_TRAN
      tran_prod_count:
        type: STRING
        description: Unique Number added by Ishan
        sourceColumn: "TRAN_PROD_COUNT         "
        sourceTable: QACP_TRAN
      insp_base_value:
        type: STRING
        description: Mean(Provided in system)
        sourceColumn: "INSP_BASE_VALUE         "
        sourceTable: QACP_INSP_ITEM
      insp_ltlr:
        type: STRING
        description: LSL -Lower spec limit
        sourceColumn: "INSP_LTLR               "
        sourceTable: QACP_INSP_ITEM
      insp_utlr:
        type: STRING
        description: USL - Upper spec limit
        sourceColumn: "INSP_UTLR               "
        sourceTable: QACP_INSP_ITEM
      insp_unit:
        type: STRING
        description: Dimension (cm,mm, etc)
        sourceColumn: "INSP_UNIT               "
        sourceTable: QACP_INSP_ITEM
      part_catg:
        type: STRING
        description: A/R/AR
        sourceColumn: "PART_CATG               "
        sourceTable: QACP_PART
      insp_smpl_cnt:
        type: STRING
        description: Number of samples available for Cosideration
        sourceColumn: "INSP_SMPL_CNT           "
        sourceTable: QACP_INSP_ITEM
      sm1:
        type: STRING
        description: NG/None
        sourceColumn: "SM1                     "
        sourceTable: ""
      tran_sample1:
        type: STRING
        description: 1st sample value entered by vendor
        sourceColumn: TRAN_SAMPLE1
        sourceTable: QACP_TRAN
      sm2:
        type: STRING
        description: NG/None
        sourceColumn: "SM2                     "
        sourceTable: ""
      tran_sample2:
        type: STRING
        description: 2nd sample value entered by vendor
        sourceColumn: TRAN_SAMPLE2
        sourceTable: QACP_TRAN
      sm3:
        type: STRING
        description: NG/None
        sourceColumn: "SM3                     "
        sourceTable: ""
      tran_sample3:
        type: STRING
        description: 3rd sample value entered by vendor
        sourceColumn: TRAN_SAMPLE3
        sourceTable: QACP_TRAN
      sm4:
        type: STRING
        description: NG/None
        sourceColumn: "SM4                     "
        sourceTable: ""
      tran_sample4:
        type: STRING
        description: 4th sample value entered by vendor
        sourceColumn: TRAN_SAMPLE4
        sourceTable: QACP_TRAN
      sm5:
        type: STRING
        description: NG/None
        sourceColumn: "SM5                     "
        sourceTable: ""
      tran_sample5:
        type: STRING
        description: 5th sample value entered by vendor
        sourceColumn: TRAN_SAMPLE5
        sourceTable: QACP_TRAN
      sm6:
        type: STRING
        description: NG/None
        sourceColumn: "SM6                     "
        sourceTable: ""
      tran_sample6:
        type: STRING
        description: 6th sample value entered by vendor
        sourceColumn: TRAN_SAMPLE6
        sourceTable: QACP_TRAN
      sm7:
        type: STRING
        description: NG/None
        sourceColumn: "SM7                     "
        sourceTable: ""
      tran_sample7:
        type: STRING
        description: 7th sample value entered by vendor
        sourceColumn: TRAN_SAMPLE7
        sourceTable: QACP_TRAN
      sm8:
        type: STRING
        description: NG/None
        sourceColumn: "SM8                     "
        sourceTable: ""
      tran_sample8:
        type: STRING
        description: 8th sample value entered by vendor
        sourceColumn: TRAN_SAMPLE8
        sourceTable: QACP_TRAN
      sm9:
        type: STRING
        description: NG/None
        sourceColumn: "SM9                     "
        sourceTable: ""
      tran_sample9:
        type: STRING
        description: 9th sample value entered by vendor
        sourceColumn: TRAN_SAMPLE9
        sourceTable: QACP_TRAN
      sm10:
        type: STRING
        description: NG/None
        sourceColumn: "SM10                    "
        sourceTable: ""
      tran_sample10:
        type: STRING
        description: 10th sample value entered by vendor
        sourceColumn: TRAN_SAMPLE10
        sourceTable: QACP_TRAN
      counta:
        type: STRING
        description: Unique number for each sample value in defined composite key
        sourceColumn: "CountA                  "
        sourceTable: ""
      min:
        type: STRING
        description: Min of all samples
        sourceColumn: "min                     "
        sourceTable: ""
      max:
        type: STRING
        description: Max of all samples
        sourceColumn: "max                     "
        sourceTable: ""
      range:
        type: STRING
        description: Difference of Max and Min
        sourceColumn: "range                   "
        sourceTable: ""
      mean:
        type: STRING
        description: mean of samples
        sourceColumn: "mean                    "
        sourceTable: ""
      prev_value:
        type: STRING
        description: previous entry in sample 1
        sourceColumn: "prev_value              "
        sourceTable: ""
      moving_range:
        type: STRING
        description: in case of sample count 1, this field is required to calculate range
        sourceColumn: "Moving_range            "
        sourceTable: ""
      xbb:
        type: STRING
        description: mean of mean column
        sourceColumn: "Xbb                     "
        sourceTable: ""
      rbar:
        type: STRING
        description: Row by agonizing row
        sourceColumn: "Rbar                    "
        sourceTable: ""
      sigma:
        type: STRING
        description: Standard Deviation
        sourceColumn: "Sigma                   "
        sourceTable: ""
      cp:
        type: STRING
        description: Critical Parameter
        sourceColumn: "Cp                      "
        sourceTable: ""
      cpl:
        type: STRING
        description: Lower CP
        sourceColumn: "Cpl                     "
        sourceTable: ""
      cpu:
        type: STRING
        description: Upper CP
        sourceColumn: "Cpu                     "
        sourceTable: ""
      cpk:
        type: STRING
        description: Critical Parameter Indices
        sourceColumn: "Cpk                     "
        sourceTable: ""
      xbar_ucl:
        type: STRING
        description: Xbar Upper Control Limit
        sourceColumn: "Xbar_UCL                "
        sourceTable: ""
      xbar_lcl:
        type: STRING
        description: Xbar Lower Control Limit
        sourceColumn: "Xbar_LCL                "
        sourceTable: ""
      rchart_ucl:
        type: STRING
        description: R Chart Upper Control Limit
        sourceColumn: "RChart_UCL              "
        sourceTable: ""
      rchart_lcl:
        type: STRING
        description: R Chart Lower Control Limit
        sourceColumn: "RChart_LCL              "
        sourceTable: ""
      xchart_ucl:
        type: STRING
        description: X Chart Upper Control Limit
        sourceColumn: "XChart_UCL              "
        sourceTable: ""
      xchart_lcl:
        type: STRING
        description: X Chart Lower Control Limit
        sourceColumn: "XChart_LCL              "
        sourceTable: ""
      mrchart_ucl:
        type: STRING
        description: MR Chart Upper Control Limit
        sourceColumn: "MRChart_UCL             "
        sourceTable: ""
      mrchart_lcl:
        type: STRING
        description: MR Chart Lower Control Limit
        sourceColumn: "MRChart_LCL             "
        sourceTable: ""
      flag_usl_lsl:
        type: STRING
        description: If any sample value is less than LSL and greater than USL, then
          this flag will be true
        sourceColumn: "Flag_USL_LSL            "
        sourceTable: ""
      flag_xbar_ucl_lcl:
        type: STRING
        description: If any mean value is breaching the Xbar UCL LCL Limit, then this
          flag will be true
        sourceColumn: "Flag_XBar_UCL_LCL       "
        sourceTable: ""
      flag_rchart_ucl_lcl:
        type: STRING
        description: If any range value is breaching the Rchart UCL LCL Limit, then this
          flag will be true
        sourceColumn: "Flag_RChart_UCL_LCL     "
        sourceTable: ""
      flag_xchart_ucl_lcl:
        type: STRING
        description: If any mean value is breaching the XChart UCL LCL Limit, then this
          flag will be true
        sourceColumn: "Flag_XChart_UCL_LCL     "
        sourceTable: ""
      flag_mrchart_ucl_lcl:
        type: STRING
        description: If any moving range value is breaching the Rchart UCL LCL Limit,
          then this flag will be true
        sourceColumn: "Flag_MRChart_UCL_LCL    "
        sourceTable: ""
      validation_usl_lsl:
        type: STRING
        description: Flag to check if Cp flag is greater than Cpk
        sourceColumn: "Validation_USL_LSL      "
        sourceTable: ""
      cp_flag:
        type: STRING
        description: Flag to categorise cp values in low, medium or high
        sourceColumn: "cp_flag                 "
        sourceTable: ""
      cpk_flag:
        type: STRING
        description: Flag to categorise cpk values in low, medium or high
        sourceColumn: "cpk_flag                "
        sourceTable: ""
      continous_flag_alert:
        type: STRING
        description: If mean value is increasing or decreasing continously for 7 days,
          this flag will be set to 1
        sourceColumn: "continous_Flag_alert    "
        sourceTable: ""
      alert_details:
        type: STRING
        description: categorise the alerts in Beyond Control Limit, Beyond Spec Limit,
          Beyond Control Band, 7 points up or down
        sourceColumn: "Alert Details           "
        sourceTable: ""
      _7_points_up:
        type: STRING
        description: If mean value is increasing continously for 7 days
        sourceColumn: "_7_points_up            "
        sourceTable: ""
      _7_points_down:
        type: STRING
        description: If mean value is increasing decreasing for 7 days
        sourceColumn: "_7_points_down          "
        sourceTable: ""
      runchart_ucl:
        type: STRING
        description: Upper control band limit with 80% margin
        sourceColumn: "RunChart_UCL            "
        sourceTable: ""
      runchart_lcl:
        type: STRING
        description: Lower control band limit with 80% margin
        sourceColumn: "RunChart_LCL            "
        sourceTable: ""
      flag_sample1_band:
        type: STRING
        description: Sample 1 Band if greater than Lower Spec limit but less than lower
          control limit
        sourceColumn: "Flag_Sample1_Band       "
        sourceTable: ""
      flag_sample2_band:
        type: STRING
        description: Sample 2 Band if greater than Lower Spec limit but less than lower
          control limit
        sourceColumn: "Flag_Sample2_Band       "
        sourceTable: ""
      flag_sample3_band:
        type: STRING
        description: Sample 3 Band if greater than Lower Spec limit but less than lower
          control limit
        sourceColumn: "Flag_Sample3_Band       "
        sourceTable: ""
      flag_sample4_band:
        type: STRING
        description: Sample 4 Band if greater than Lower Spec limit but less than lower
          control limit
        sourceColumn: "Flag_Sample4_Band       "
        sourceTable: ""
      flag_sample5_band:
        type: STRING
        description: Sample 5 Band if greater than Lower Spec limit but less than lower
          control limit
        sourceColumn: "Flag_Sample5_Band       "
        sourceTable: ""
      flag_sample6_band:
        type: STRING
        description: Sample 6 Band if greater than Lower Spec limit but less than lower
          control limit
        sourceColumn: flag_sample6_band
        sourceTable: ""
      flag_sample7_band:
        type: STRING
        description: Sample 7 Band if greater than Lower Spec limit but less than lower
          control limit
        sourceColumn: flag_sample7_band
        sourceTable: ""
      flag_sample8_band:
        type: STRING
        description: Sample 8 Band if greater than Lower Spec limit but less than lower
          control limit
        sourceColumn: flag_sample8_band
        sourceTable: ""
      flag_sample9_band:
        type: STRING
        description: Sample 9 Band if greater than Lower Spec limit but less than lower
          control limit
        sourceColumn: flag_sample9_band
        sourceTable: ""
      flag_sample10_band:
        type: STRING
        description: Sample 10 Band if greater than Lower Spec limit but less than lower
          control limit
        sourceColumn: flag_sample10_band
        sourceTable: ""
      insp_smpl_feq:
        type: STRING
        description: smpl feq
        sourceColumn: insp_smpl_feq
        sourceTable: QACP_INSP_ITEM
      insp_part_rmrk:
        type: STRING
        description: Part remarks
        sourceColumn: insp_part_rmrk
        sourceTable: QACP_INSP_ITEM
      insp_ctrl_limt:
        type: STRING
        description: Control limit
        sourceColumn: insp_ctrl_limt
        sourceTable: QACP_INSP_ITEM
      insp_ctrl_point:
        type: STRING
        description: Control point
        sourceColumn: insp_ctrl_point
        sourceTable: QACP_INSP_ITEM
      insp_ctrl_band:
        type: STRING
        description: Control band
        sourceColumn: insp_ctrl_band
        sourceTable: QACP_INSP_ITEM
      insp_close_alrt:
        type: STRING
        description: Close alert
        sourceColumn: insp_close_alrt
        sourceTable: QACP_INSP_ITEM
      insp_src:
        type: STRING
        description: Source
        sourceColumn: insp_src
        sourceTable: QACP_INSP_ITEM
      insp_catg:
        type: STRING
        description: Category
        sourceColumn: insp_catg
        sourceTable: QACP_INSP_ITEM
      insp_misp_plan:
        type: STRING
        description: misp plan
        sourceColumn: insp_misp_plan
        sourceTable: QACP_INSP_ITEM
      etl_inserted_date:
        type: DATETIME
        description: ETL Audit Field to identify record insertion date
        sourceColumn: Manual
        sourceTable: Manual
      etl_modified_date:
        type: DATETIME
        description: ETL Audit Field to identify record modified date
        sourceColumn: Manual
        sourceTable: Manual
      etl_created_by:
        type: STRING
        description: ETL Audit Field to identify record created by user
        sourceColumn: Manual
        sourceTable: Manual
      etl_updated_by:
        type: STRING
        description: ETL Audit Field to identify record modified by user
        sourceColumn: Manual
        sourceTable: Manual
  enforceSchemaMethod: ""
  isProfilingEnabled: false
transformation:
  - isDynamic: true
    alias: EMR_PySpark_1
    description: SADP to ADP Transformation
    sequence: 4
    arguments: []
    pythonFilePath: s3://msil-dataverse-quality-assurance/Pyspark_Scripts/critical_parameters/critical_parameter_details.py
    inputDataFrameList:
      - inputDataFrame: ""
        tempViewName: ""
    optional:
      sparkExtraConf:
        --jars: s3://msil-data-lake-raw/InputData/Test/IMKT/test_iceberg_write/iceberg-core-1.4.3.jar,s3://msil-data-lake-raw/InputData/Test/IMKT/test_iceberg_write/iceberg-spark-runtime-3.3_2.12-1.4.3.jar,s3://msil-data-lake-raw/InputData/Test/IMKT/test_iceberg_write/iceberg-aws-bundle-1.4.3.jar,s3://msil-dataverse-quality-assurance/Temp_Dumps/delta-core_2.12-0.2.0.jar,s3://msil-dataverse-quality-assurance/Temp_Dumps/iceberg-spark3-runtime-0.13.2.jar
    type: customPySparkEMRServerless
controlPort:
  dataQualityRules:
    RecordCountCheck:
      productState:
        expression: ">"
        number: 0
        referenceAlias: Write_to_Iceberg
    NullValueCheck:
      productState:
        checks:
          - column: PART_VEND_CODE
          - column: INSP_PART_CODE
          - column: INSP_ITEM
          - column: TRAN_PROD_DATE
        referenceAlias: Write_to_Iceberg
outputPort:
  subscriptionChannels:
    - channelType: Postgres
      queryType: SQL
    - channelType: Dataproduct
      queryType: SQL
